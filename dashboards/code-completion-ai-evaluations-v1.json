{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": null,
  "links": [

  ],
  "liveNow": false,
  "panels": [
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "gridPos": {
        "h": 11,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 20,
      "options": {
        "code": {
          "language": "html",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "### 16.3 Initial Draft for Movel Evals of Code Completion for Google Models\n#### Error and data analysis is in progress to confirm accuracy / insights/ recommendations\n\n##### Insights Summary:\n\n1. In the current state, the first iteration comprises 3450 distinct prompts curated from 11 open-source GitLab projects spanning 8 languages (Python, Golang, Ruby, TypeScript, JavaScript, Rust, C#, C).\n\n2. A significant portion of null values exists, which will be subject to further investigation and curation specifically for the next iteration focused on `text-bison`. Some of these null values are genuinely missing, while others represent errors. Our error analysis and investigation have been ongoing for only 2 days, and we intend to continue this process over the next two weeks, providing weekly updates.\n\n3. Despite the presence of null values as a separate category, `code-gecko` remains superior for code completion across 8 languages, serving as the base model.\n\n4. Upon inspecting the high-similarity bucket and selectively testing in the Web IDE, we gain insight into the proxy for opportunity: pinpointing the cursor location that should trigger a suggestion. This approach holds the potential to significantly enhance acceptance. For specific prompts and languages, the segments (chunks) serve as the proxy for identifying when a suggestion should be presented, closely mirroring developer-written code. This phenomenon is observable in the base model without employing any prompt transformation. \n\n5. We have also conducted testing on the prompt transformations applied in a production setting to assess their impact. Additional details can be found in the experiment panel.\n\n6. For similarity scores falling between `0.16` and `0.65` for `code-gecko`, optimization opportunities have emerged, particularly related to function declarations in JavaScript and Golang, and function definitions in Python.\n\n7. Our error analysis is still in its early stages, and we anticipate incorporating more recommendations iteratively within the experiment panel over the next 2 weeks.\n\n8. Furthermore, the panel structure consists of an overview section, followed by a developer investigation tab that facilitates language and model filtering. Subsequently, an experiments panel is available to document hypotheses and recommendations regarding prompt engineering. \n",
        "mode": "markdown"
      },
      "pluginVersion": "10.1.5",
      "title": "Summary",
      "type": "text"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 11
      },
      "id": 6,
      "panels": [

      ],
      "title": "General (Overview) ",
      "type": "row"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 3,
        "w": 5,
        "x": 0,
        "y": 12
      },
      "id": 21,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.1.5",
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT COUNT(DISTINCT(project_id)) AS `Distinct Prompt Count`\nFROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\nWHERE similarity_score BETWEEN ifnull($low_score, 0) and ifnull($high_score, 1.00)",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Project Count",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "percentunit"
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 3,
        "w": 5,
        "x": 5,
        "y": 12
      },
      "id": 16,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [

          ],
          "fields": "",
          "values": false
        },
        "text": {
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.1.5",
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT AVG(similarity_score) AS mean,\nFROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\nORDER BY mean DESC\n",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Mean Similarity Score",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 9,
        "w": 7,
        "x": 10,
        "y": 12
      },
      "id": 12,
      "options": {
        "bucketOffset": 0,
        "legend": {
          "calcs": [

          ],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": false
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT\n  similarity_score\nFROM\n  `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Similarity Score Distribution",
      "type": "histogram"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "type": "linear"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 9,
        "w": 7,
        "x": 17,
        "y": 12
      },
      "id": 4,
      "options": {
        "barRadius": 0,
        "barWidth": 0.85,
        "fullHighlight": false,
        "groupWidth": 0.7,
        "legend": {
          "calcs": [

          ],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": false
        },
        "orientation": "horizontal",
        "showValue": "auto",
        "stacking": "none",
        "tooltip": {
          "mode": "single",
          "sort": "none"
        },
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT lang_id, COUNT(*) AS `Prompt Count`\nFROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\nWHERE similarity_score BETWEEN ifnull($low_score, 0) and ifnull($high_score, 1.00)\nGROUP BY lang_id\nORDER BY `Prompt Count` DESC",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Prompt Count By Language",
      "type": "barchart"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 3,
        "w": 5,
        "x": 0,
        "y": 15
      },
      "id": 1,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.1.5",
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT COUNT(*) AS `Prompt Count`\nFROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\nWHERE similarity_score BETWEEN ifnull($low_score, 0) and ifnull($high_score, 1.00)",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Prompt Count",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "percentunit"
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 3,
        "w": 5,
        "x": 5,
        "y": 15
      },
      "id": 14,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [

          ],
          "fields": "",
          "values": false
        },
        "text": {
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.1.5",
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT\n  MAX(percentile95) AS percentile95,\nFROM (\n  SELECT\n    PERCENTILE_CONT(similarity_score, 0.95) OVER() AS percentile95,\n  FROM\n    `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`)\nORDER BY\n  percentile95 DESC\n",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "95 Pct Similarity Score",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-YlRd"
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "#E24D42",
                "value": 9
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 3,
        "w": 5,
        "x": 0,
        "y": 18
      },
      "id": 2,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.1.5",
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT 100 * SUM(CASE\n    WHEN similarity_score=0 THEN 1\n    ELSE 0 \n    END) / COUNT(*) `Percentage Zero`\nFROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Prompts with Score = 0 (%)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "percentunit"
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 3,
        "w": 5,
        "x": 5,
        "y": 18
      },
      "id": 15,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [

          ],
          "fields": "",
          "values": false
        },
        "text": {
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.1.5",
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT\n  MAX(median) AS median,\nFROM (\n  SELECT\n    PERCENTILE_CONT(similarity_score, 0.5) OVER() AS median,\n  FROM\n    `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`)\nORDER BY\n  median DESC\n",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Median Similarity Score",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "mappings": [

          ],
          "unit": "none"
        },
        "overrides": [
          {
            "__systemRef": "hideSeriesFrom",
            "matcher": {
              "id": "byNames",
              "options": {
                "mode": "exclude",
                "names": [
                  "Count"
                ],
                "prefix": "All except:",
                "readOnly": true
              }
            },
            "properties": [
              {
                "id": "custom.hideFrom",
                "value": {
                  "legend": false,
                  "tooltip": false,
                  "viz": true
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 16,
        "w": 5,
        "x": 0,
        "y": 21
      },
      "id": 25,
      "options": {
        "displayLabels": [
          "percent"
        ],
        "legend": {
          "displayMode": "table",
          "placement": "right",
          "showLegend": true,
          "values": [
            "value"
          ]
        },
        "pieType": "donut",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "limit": 5,
          "values": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT\n  count(*) as `Count`,\n  CASE\n    WHEN similarity_score >= 0.95 THEN 'High'\n    WHEN similarity_score >= 0.85 THEN 'Medium'\n    WHEN similarity_score = 0 THEN 'Zero'\n    ELSE \"Low\"\n  END AS accept_likelihood,\nFROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\nGROUP BY accept_likelihood",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Volume of Similarity Bucket (% of total prompts) ",
      "transformations": [

      ],
      "type": "piechart"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "mode": "basic",
              "type": "gauge",
              "valueDisplayMode": "text"
            },
            "inspect": false
          },
          "mappings": [

          ],
          "max": 1,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "#EAB839",
                "value": 0.85
              },
              {
                "color": "green",
                "value": 0.95
              }
            ]
          },
          "unit": "percentunit"
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 9,
        "w": 19,
        "x": 5,
        "y": 21
      },
      "id": 3,
      "options": {
        "cellHeight": "md",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "10.1.5",
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "WITH groupedData as (\n  SELECT 'All' as lang_id, model, AVG(similarity_score) as avg_score\n  FROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\n  WHERE similarity_score != 0\n  GROUP BY model\n  UNION All\n  SELECT lang_id, model, AVG(similarity_score) AS avg_score\n  FROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\n  WHERE similarity_score != 0\n  GROUP BY lang_id, model\n)\n\nSELECT\n  lang_id,\n  model,\n  avg_score as `Average Score`\nFROM\n  groupedData",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Similarity Scores by Model and Language",
      "transformations": [
        {
          "id": "groupingToMatrix",
          "options": {
            "columnField": "lang_id",
            "rowField": "model",
            "valueField": "Average Score"
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
            },
            "indexByName": {
              "All": 1,
              "c_sharp": 3,
              "go": 8,
              "javascript": 7,
              "model\\lang_id": 0,
              "python": 6,
              "ruby": 5,
              "rust": 2,
              "typescript": 4
            },
            "renameByName": {
              "All": "",
              "model\\lang_id": "Model / Language"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "mode": "basic",
              "type": "gauge",
              "valueDisplayMode": "text"
            },
            "inspect": false
          },
          "mappings": [

          ],
          "max": 1,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "#EAB839",
                "value": 0.85
              },
              {
                "color": "green",
                "value": 0.95
              }
            ]
          },
          "unit": "percentunit"
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 7,
        "w": 19,
        "x": 5,
        "y": 30
      },
      "id": 13,
      "options": {
        "cellHeight": "lg",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "10.1.5",
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "WITH groupedData as (\n  SELECT 'All' as lang_id, model, AVG(similarity_score) as avg_score\n  FROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\n  WHERE similarity_score != 0\n  GROUP BY model\n  UNION All\n  SELECT lang_id, model, AVG(similarity_score) AS avg_score\n  FROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\n  WHERE similarity_score != 0\n  GROUP BY lang_id, model\n)\n\nSELECT\n  lang_id,\n  model,\n  avg_score as `Average Score`\nFROM\n  groupedData",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Similarity Scores by Chunking Method and Language",
      "transformations": [
        {
          "id": "groupingToMatrix",
          "options": {
            "columnField": "lang_id",
            "rowField": "Average Score",
            "valueField": "Average Score"
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
            },
            "indexByName": {
              "All": 0,
              "Average Score\\lang_id": 1,
              "c": 10,
              "c_sharp": 3,
              "cpp": 12,
              "go": 5,
              "java": 11,
              "javascript": 6,
              "php": 9,
              "python": 8,
              "ruby": 7,
              "rust": 2,
              "typescript": 4
            },
            "renameByName": {
              "Chunking Method\\lang_id": "Method / Language",
              "model\\lang_id": "Model / Language"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "mode": "basic",
              "type": "gauge",
              "valueDisplayMode": "text"
            },
            "inspect": false,
            "minWidth": 100
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "none"
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 13,
        "w": 24,
        "x": 0,
        "y": 37
      },
      "id": 24,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "10.1.5",
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT\n  lang_id,\n  SUM(symbol.class_definition) AS class_definition,\n  SUM(symbol.method_declaration) AS method_declaration,\n  SUM(symbol.function_definition) as function_definition,\n  SUM(symbol.type_declaration) as type_declaration,\n  SUM(symbol.trait_item) as trait_item,\n  SUM(symbol.preproc_include) AS preproc_include,\n  SUM(symbol.class_declaration) AS class_declaration,\n  SUM(symbol.namespace_use_declaration) AS namespace_use_declaration,\n  SUM(symbol.use_declaration) AS use_declaration,\n  SUM(symbol.using_directive) AS using_directive,\n  SUM(symbol.import_statement) AS import_statement,\n  SUM(symbol.declaration) AS declaration,\n  SUM(symbol.struct_item) AS struct_item,\n  SUM(symbol.function_declaration) AS function_declaration,\n  SUM(symbol.import_declaration) AS import_declaration,\n  SUM(symbol.import_static) AS import_static,\n  SUM(symbol.decorated_definition) AS decorated_definition,\n  SUM(symbol.method) AS method,\n  SUM(symbol.function_item) AS function_item,\n  SUM(symbol.import_from_statement) AS import_from_statement,\n  SUM(symbol.call) AS call,\n  SUM(symbol.field_declaration) as field_declaration,\n  SUM(symbol.class) AS class,\n  SUM(symbol.method_definition) AS method_definition\nFROM\n  `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v1`\nGROUP BY lang_id\n",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Symbol Counts by Language",
      "transformations": [
        {
          "id": "filterByValue",
          "options": {
            "filters": [

            ],
            "match": "all",
            "type": "exclude"
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "transformation"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 234
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 22,
        "w": 24,
        "x": 0,
        "y": 50
      },
      "id": 5,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [

        ]
      },
      "pluginVersion": "10.1.5",
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT\n  lang_id,\n  project_name AS `Project Name`,\n  model,\n  transformation,\n  post_transformation,\n  prompt_prefix AS `Prompt Input`,\n  prompt_suffix AS `Developer Completion`,\n  model_completion AS `Model Completion`,\n  chunking_method AS `Chunking Method`,\n  similarity_score AS `Average Score`,\n  CASE\n    WHEN similarity_score >= 0.95 THEN 'high'\n    WHEN similarity_score >= 0.85 THEN 'medium'\n    ELSE 'low'\n  END AS `Similarity Bucket`,\nFROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\nWHERE similarity_score != 0 and similarity_score BETWEEN ifnull($low_score, 0) and ifnull($high_score, 1.00)",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Prompt Library",
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 72
      },
      "id": 7,
      "panels": [

      ],
      "title": "Analysis tool  with filters ($programming_language & $model)",
      "type": "row"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 6,
        "w": 5,
        "x": 0,
        "y": 73
      },
      "id": 8,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.1.5",
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT COUNT(*) AS `Prompt Count`\nFROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\nWHERE lang_id IN UNNEST([$programming_language]) AND model IN UNNEST([$model]) AND transformation IN UNNEST([$transformation]) AND similarity_score BETWEEN ifnull($low_score, 0) and ifnull($high_score, 1.00) AND post_transformation IN UNNEST([$post_transformation])",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Prompt Count ($programming_language)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": true,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "hidden",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "type": "linear"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 12,
        "w": 7,
        "x": 5,
        "y": 73
      },
      "id": 23,
      "options": {
        "barRadius": 0,
        "barWidth": 0.8,
        "fullHighlight": false,
        "groupWidth": 1,
        "legend": {
          "calcs": [

          ],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "orientation": "vertical",
        "showValue": "always",
        "stacking": "none",
        "tooltip": {
          "mode": "single",
          "sort": "none"
        },
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "pluginVersion": "9.5.1",
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT\n  lang_id,\n  SUM(symbol.class_definition) AS class_definition,\n  SUM(symbol.method_declaration) AS method_declaration,\n  SUM(symbol.function_definition) as function_definition,\n  SUM(symbol.type_declaration) as type_declaration,\n  SUM(symbol.trait_item) as trait_item,\n  SUM(symbol.preproc_include) AS preproc_include,\n  SUM(symbol.class_declaration) AS class_declaration,\n  SUM(symbol.namespace_use_declaration) AS namespace_use_declaration,\n  SUM(symbol.use_declaration) AS use_declaration,\n  SUM(symbol.using_directive) AS using_directive,\n  SUM(symbol.import_statement) AS import_statement,\n  SUM(symbol.declaration) AS declaration,\n  SUM(symbol.struct_item) AS struct_item,\n  SUM(symbol.function_declaration) AS function_declaration,\n  SUM(symbol.import_declaration) AS import_declaration,\n  SUM(symbol.import_static) AS import_static,\n  SUM(symbol.decorated_definition) AS decorated_definition,\n  SUM(symbol.method) AS method,\n  SUM(symbol.function_item) AS function_item,\n  SUM(symbol.import_from_statement) AS import_from_statement,\n  SUM(symbol.call) AS call,\n  SUM(symbol.field_declaration) as field_declaration,\n  SUM(symbol.class) AS class,\n  SUM(symbol.method_definition) AS method_definition\nFROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v1`\nWHERE lang_id IN UNNEST([$programming_language])\nGROUP BY lang_id",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Symbol Counts ($programming_language)",
      "transformations": [
        {
          "id": "groupBy",
          "options": {
            "fields": {
              "lang_id": {
                "aggregations": [

                ]
              }
            }
          }
        }
      ],
      "type": "barchart"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 12,
        "y": 73
      },
      "id": 10,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "10.1.5",
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "WITH info AS (\n  SELECT lang_id, chunking_method, model, transformation, post_transformation, AVG(similarity_score) as avg_score,\n  FROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\n  WHERE similarity_score != 0\n  GROUP BY  lang_id, chunking_method, model, transformation, post_transformation\n)\n\nSELECT\n  model,\n  chunking_method AS `Chunking Method`,\n  lang_id AS `Language`,\n  avg_score AS `Average Score`,\n  CASE\n    WHEN avg_score >= 0.95 THEN 'high'\n    WHEN avg_score >= 0.85 THEN 'medium'\n    ELSE 'low'\n  END AS `Acceptance Likelihood`,\nFROM\n  info\nWHERE lang_id IN UNNEST([$programming_language]) AND model IN UNNEST([$model]) AND transformation IN UNNEST([$transformation])AND post_transformation IN UNNEST([$post_transformation])\nORDER BY model, `Acceptance Likelihood` DESC",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Model, Chunking Method  by Average Score ($programming_language)",
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 6,
        "w": 5,
        "x": 0,
        "y": 79
      },
      "id": 9,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.1.5",
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT 100 * SUM(CASE\n    WHEN similarity_score=0 THEN 1\n    ELSE 0 \n    END) / COUNT(*) `Percentage Zero`\nFROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\nWHERE lang_id IN UNNEST([$programming_language]) AND model IN UNNEST([$model]) AND transformation IN UNNEST([$transformation]) AND post_transformation IN UNNEST([$post_transformation])",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "% Prompts with Score = 0 ($programming_language)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 12,
        "y": 79
      },
      "id": 19,
      "options": {
        "bucketOffset": 0,
        "legend": {
          "calcs": [

          ],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": false
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT\n  similarity_score\nFROM\n  `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\nWHERE lang_id IN UNNEST([$programming_language]) AND model IN UNNEST([$model]) AND transformation IN UNNEST([$transformation]) AND post_transformation IN UNNEST([$post_transformation])",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Similarity Score Distribution ($programming_language)",
      "type": "histogram"
    },
    {
      "datasource": {
        "type": "grafana-bigquery-datasource",
        "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "filterable": true,
            "inspect": false
          },
          "mappings": [

          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [

        ]
      },
      "gridPos": {
        "h": 22,
        "w": 24,
        "x": 0,
        "y": 85
      },
      "id": 11,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": false,
            "displayName": "Prompt Input"
          }
        ]
      },
      "pluginVersion": "10.1.5",
      "targets": [
        {
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
          },
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT\n  lang_id,\n  model,\n  prompt_id AS `Prompt ID`,\n  transformation,\n  post_transformation,\n  prompt_prefix AS `Prompt Input`,\n  prompt_suffix AS `Developer Completion`,\n  model_completion AS `Model Completion`,\n  chunking_method AS `Chunking Method`,\n  similarity_score AS `Average Score`,\n  CASE\n    WHEN similarity_score >= 0.95 THEN 'high'\n    WHEN similarity_score >= 0.85 THEN 'medium'\n    ELSE 'low'\n  END AS `Acceptance Likelihood`,\nFROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\nWHERE similarity_score != 0 AND lang_id IN UNNEST([$programming_language]) AND model IN UNNEST([$model]) AND transformation IN UNNEST ([$transformation]) AND similarity_score BETWEEN ifnull($low_score, 0) and ifnull($high_score, 1.00)",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Prompt Library ($programming_language)",
      "type": "table"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 107
      },
      "id": 18,
      "panels": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "PA258B30F88C30650"
          },
          "gridPos": {
            "h": 17,
            "w": 24,
            "x": 0,
            "y": 108
          },
          "id": 17,
          "options": {
            "code": {
              "language": "plaintext",
              "showLineNumbers": false,
              "showMiniMap": false
            },
            "content": "| Iteration | Model            | Language      | Hypothesis/Recommendation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Action                                                                                                                                                                                                                 | Example Prompt Id                                                                                                |\n| --------- | ---------------- | ------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------- |\n| 16.3      | code-gecko       | Python        | We have noticed that code lacking string context yields a lower similarity score. After implementing [this transformation](https://gitlab.com/gitlab-org/modelops/applied-ml/code-suggestions/ai-assist/-/blob/main/codesuggestions/suggestions/processing/completions.py#L150) in the production environment, which was tested through the prompt library, there was a 3.58% increase in the similarity score                                                                                                                                            | Hypothesis to be pushed for all languages in production as [here](https://gitlab.com/gitlab-org/modelops/applied-ml/code-suggestions/ai-assist/-/blob/main/codesuggestions/suggestions/processing/completions.py#L150) | TBD                                                                                                              |\n| 16.3      | code-gecko       | All Languages | At times, we encounter low similarity scores due to the model producing excessive noise. For instance, there are instances where the model has already successfully completed the current function but proceeds to suggest a new function. Such occurrences can introduce noise and potentially frustrate the user.                                                                                                                                                                                                                                       | Postprocess and cleanup the response to stop at new blocks (such as a new function, new class etc.). Hypothesis to be implemented in Production                                                                        | dcb4a241-e66d-5ce6-bb02-2caa510ea2d8-1620-current_block , 7ce60202-6092-5de7-92f6-9423da63cf12-406-current_block |\n| 16.3      | code-gecko       | All Languages | We saw a noticeable increase in similarity score when including filepath irrespective of language                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Hypothesis to be implemented in production                                                                                                                                                                             | TBD                                                                                                              |\n| 16.3      | Model Comparison | All languages | Based on [Analysis here](https://colab.research.google.com/drive/1l2XeXmDnelqNHY6mU544A32Qmj13Jjl7?usp=sharing) after conducting an analysis on various prompts, it's evident that there is room for improvement in the opportunity metric. The question arises: where should the cursor be positioned to receive more meaningful recommendations and ensure that the model's output closely resembles that of a developer's? We particular dive into similarity_bucket of High to understand where the cursor should be for what kind of recommendations | Explore how to use the segment logic on the client side to help with acceptance rate and run A/B test in production                                                                                                    | c6a3dc03-ffa0-56fd-811e-beb165e6d17e-424- , 580bb6c9-60cb-53f6-96aa-44e2349f1554-31-                             |\n| 16.3      | Model Comparison | All languages | Taking the null value out , we consistently see `code-gecko` perform superior in reference to `code-bison` and `text-bison`                                                                                                                                                                                                                                                                                                                                                                                                                               | Keep code-gecko in production while we further investigate more date the optimal use-cases where text-bison / code-bison outperforms for code completion                                                               | NA                                                                                                               |",
            "mode": "markdown"
          },
          "pluginVersion": "10.1.5",
          "title": "Prompt Transformation Experiment List",
          "type": "text"
        }
      ],
      "title": "Experiments / Hypothesis / Recommendations",
      "type": "row"
    }
  ],
  "refresh": "",
  "schemaVersion": 38,
  "style": "dark",
  "tags": [
    "protected",
    "unmanaged"
  ],
  "templating": {
    "list": [
      {
        "current": {
          "selected": true,
          "text": [
            "go",
            "c_sharp",
            "typescript"
          ],
          "value": [
            "go",
            "c_sharp",
            "typescript"
          ]
        },
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
        },
        "definition": "",
        "description": "Programming language options that are available in Prompt Library",
        "hide": 0,
        "includeAll": false,
        "label": "Programming Language",
        "multi": true,
        "name": "programming_language",
        "options": [

        ],
        "query": {
          "0": " ",
          "1": " ",
          "10": "I",
          "100": "B",
          "101": "Y",
          "102": " ",
          "103": " ",
          "104": "l",
          "105": "a",
          "106": "n",
          "107": "g",
          "108": "_",
          "109": "i",
          "11": "S",
          "110": "d",
          "12": "T",
          "13": "I",
          "14": "N",
          "15": "C",
          "16": "T",
          "17": "(",
          "18": "l",
          "19": "a",
          "2": "S",
          "20": "n",
          "21": "g",
          "22": "_",
          "23": "i",
          "24": "d",
          "25": ")",
          "26": "\n",
          "27": " ",
          "28": " ",
          "29": "F",
          "3": "E",
          "30": "R",
          "31": "O",
          "32": "M",
          "33": " ",
          "34": "`",
          "35": "u",
          "36": "n",
          "37": "r",
          "38": "e",
          "39": "v",
          "4": "L",
          "40": "i",
          "41": "e",
          "42": "w",
          "43": "-",
          "44": "p",
          "45": "o",
          "46": "c",
          "47": "-",
          "48": "3",
          "49": "9",
          "5": "E",
          "50": "0",
          "51": "2",
          "52": "0",
          "53": "0",
          "54": "e",
          "55": "5",
          "56": ".",
          "57": "g",
          "58": "l",
          "59": "_",
          "6": "C",
          "60": "g",
          "61": "i",
          "62": "t",
          "63": "l",
          "64": "a",
          "65": "b",
          "66": "_",
          "67": "c",
          "68": "o",
          "69": "d",
          "7": "T",
          "70": "e",
          "71": "b",
          "72": "a",
          "73": "s",
          "74": "e",
          "75": ".",
          "76": "o",
          "77": "u",
          "78": "t",
          "79": "p",
          "8": " ",
          "80": "u",
          "81": "t",
          "82": "_",
          "83": "f",
          "84": "u",
          "85": "l",
          "86": "l",
          "87": "_",
          "88": "v",
          "89": "4",
          "9": "D",
          "90": "`",
          "91": "\n",
          "92": " ",
          "93": " ",
          "94": "G",
          "95": "R",
          "96": "O",
          "97": "U",
          "98": "P",
          "99": " ",
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT DISTINCT(lang_id)\nFROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`",
          "refId": "tempvar",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "current": {
          "selected": false,
          "text": "code-gecko@001",
          "value": "code-gecko@001"
        },
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
        },
        "definition": "",
        "description": "Model name",
        "hide": 0,
        "includeAll": false,
        "label": "Model",
        "multi": true,
        "name": "model",
        "options": [

        ],
        "query": {
          "0": "S",
          "1": "E",
          "10": "T",
          "11": "I",
          "12": "N",
          "13": "C",
          "14": "T",
          "15": "(",
          "16": "m",
          "17": "o",
          "18": "d",
          "19": "e",
          "2": "L",
          "20": "l",
          "21": ")",
          "22": "\n",
          "23": "F",
          "24": "R",
          "25": "O",
          "26": "M",
          "27": " ",
          "28": "`",
          "29": "u",
          "3": "E",
          "30": "n",
          "31": "r",
          "32": "e",
          "33": "v",
          "34": "i",
          "35": "e",
          "36": "w",
          "37": "-",
          "38": "p",
          "39": "o",
          "4": "C",
          "40": "c",
          "41": "-",
          "42": "3",
          "43": "9",
          "44": "0",
          "45": "2",
          "46": "0",
          "47": "0",
          "48": "e",
          "49": "5",
          "5": "T",
          "50": ".",
          "51": "g",
          "52": "l",
          "53": "_",
          "54": "g",
          "55": "i",
          "56": "t",
          "57": "l",
          "58": "a",
          "59": "b",
          "6": " ",
          "60": "_",
          "61": "c",
          "62": "o",
          "63": "d",
          "64": "e",
          "65": "b",
          "66": "a",
          "67": "s",
          "68": "e",
          "69": ".",
          "7": "D",
          "70": "o",
          "71": "u",
          "72": "t",
          "73": "p",
          "74": "u",
          "75": "t",
          "76": "_",
          "77": "f",
          "78": "u",
          "79": "l",
          "8": "I",
          "80": "l",
          "81": "_",
          "82": "v",
          "83": "4",
          "84": "`",
          "9": "S",
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT DISTINCT(model)\nFROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`",
          "refId": "tempvar",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "current": {
          "selected": false,
          "text": "0.0",
          "value": "0.0"
        },
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
        },
        "definition": "",
        "description": "test",
        "error": {
        },
        "hide": 0,
        "includeAll": false,
        "label": "low_score",
        "multi": false,
        "name": "low_score",
        "options": [

        ],
        "query": {
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT similarity_score\nFROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\nWHERE similarity_score > $low_score\n\n\n",
          "refId": "tempvar",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "current": {
          "selected": false,
          "text": "1",
          "value": "1"
        },
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
        },
        "definition": "",
        "description": "test",
        "hide": 0,
        "includeAll": false,
        "label": "high_score",
        "multi": false,
        "name": "high_score",
        "options": [

        ],
        "query": {
          "0": "S",
          "1": "E",
          "10": "r",
          "11": "e",
          "12": "\n",
          "13": "F",
          "14": "R",
          "15": "O",
          "16": "M",
          "17": " ",
          "18": "`",
          "19": "u",
          "2": "L",
          "20": "n",
          "21": "r",
          "22": "e",
          "23": "v",
          "24": "i",
          "25": "e",
          "26": "w",
          "27": "-",
          "28": "p",
          "29": "o",
          "3": "E",
          "30": "c",
          "31": "-",
          "32": "3",
          "33": "9",
          "34": "0",
          "35": "2",
          "36": "0",
          "37": "0",
          "38": "e",
          "39": "5",
          "4": "C",
          "40": ".",
          "41": "g",
          "42": "l",
          "43": "_",
          "44": "g",
          "45": "i",
          "46": "t",
          "47": "l",
          "48": "a",
          "49": "b",
          "5": "T",
          "50": "_",
          "51": "c",
          "52": "o",
          "53": "d",
          "54": "e",
          "55": "b",
          "56": "a",
          "57": "s",
          "58": "e",
          "59": ".",
          "6": " ",
          "60": "o",
          "61": "u",
          "62": "t",
          "63": "p",
          "64": "u",
          "65": "t",
          "66": "_",
          "67": "f",
          "68": "u",
          "69": "l",
          "7": "s",
          "70": "l",
          "71": "_",
          "72": "v",
          "73": "4",
          "74": "`",
          "75": "\n",
          "76": "W",
          "77": "H",
          "78": "E",
          "79": "R",
          "8": "c",
          "80": "E",
          "81": " ",
          "82": "s",
          "83": "c",
          "84": "o",
          "85": "r",
          "86": "e",
          "87": " ",
          "88": "<",
          "89": " ",
          "9": "o",
          "90": "h",
          "91": "i",
          "92": "g",
          "93": "h",
          "94": "_",
          "95": "s",
          "96": "c",
          "97": "o",
          "98": "r",
          "99": "e",
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT similarity_score\nFROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\nWHERE similarity_score < high_score ",
          "refId": "tempvar",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "current": {
          "selected": true,
          "text": [
            "",
            "function_signatures->imports->file_name_and_language"
          ],
          "value": [
            "",
            "function_signatures->imports->file_name_and_language"
          ]
        },
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
        },
        "definition": "",
        "description": "Transformations available in prompt library.",
        "hide": 0,
        "includeAll": false,
        "label": "Transformation",
        "multi": true,
        "name": "transformation",
        "options": [

        ],
        "query": {
          "0": "S",
          "1": "E",
          "10": "T",
          "11": "I",
          "12": "N",
          "13": "C",
          "14": "T",
          "15": " ",
          "16": "t",
          "17": "r",
          "18": "a",
          "19": "n",
          "2": "L",
          "20": "s",
          "21": "f",
          "22": "o",
          "23": "r",
          "24": "m",
          "25": "a",
          "26": "t",
          "27": "i",
          "28": "o",
          "29": "n",
          "3": "E",
          "30": "\n",
          "31": "F",
          "32": "R",
          "33": "O",
          "34": "M",
          "35": " ",
          "36": "`",
          "37": "u",
          "38": "n",
          "39": "r",
          "4": "C",
          "40": "e",
          "41": "v",
          "42": "i",
          "43": "e",
          "44": "w",
          "45": "-",
          "46": "p",
          "47": "o",
          "48": "c",
          "49": "-",
          "5": "T",
          "50": "3",
          "51": "9",
          "52": "0",
          "53": "2",
          "54": "0",
          "55": "0",
          "56": "e",
          "57": "5",
          "58": ".",
          "59": "g",
          "6": " ",
          "60": "l",
          "61": "_",
          "62": "g",
          "63": "i",
          "64": "t",
          "65": "l",
          "66": "a",
          "67": "b",
          "68": "_",
          "69": "c",
          "7": "D",
          "70": "o",
          "71": "d",
          "72": "e",
          "73": "b",
          "74": "a",
          "75": "s",
          "76": "e",
          "77": ".",
          "78": "o",
          "79": "u",
          "8": "I",
          "80": "t",
          "81": "p",
          "82": "u",
          "83": "t",
          "84": "_",
          "85": "f",
          "86": "u",
          "87": "l",
          "88": "l",
          "89": "_",
          "9": "S",
          "90": "v",
          "91": "4",
          "92": "`",
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "\tSELECT DISTINCT transformation FROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\t\n\n\n\n",
          "refId": "tempvar",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "current": {
          "selected": true,
          "text": [
            "extract_completion_anthropic"
          ],
          "value": [
            "extract_completion_anthropic"
          ]
        },
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "e5881d89-0291-4ba6-bfff-b5818b9719ff"
        },
        "definition": "",
        "description": "Post transformations available in prompt library.",
        "hide": 0,
        "includeAll": false,
        "label": "Post Transformation",
        "multi": true,
        "name": "post_transformation",
        "options": [

        ],
        "query": {
          "0": "S",
          "1": "E",
          "10": "T",
          "11": "I",
          "12": "N",
          "13": "C",
          "14": "T",
          "15": " ",
          "16": "p",
          "17": "o",
          "18": "s",
          "19": "t",
          "2": "L",
          "20": "_",
          "21": "t",
          "22": "r",
          "23": "a",
          "24": "n",
          "25": "s",
          "26": "f",
          "27": "o",
          "28": "r",
          "29": "m",
          "3": "E",
          "30": "a",
          "31": "t",
          "32": "i",
          "33": "o",
          "34": "n",
          "35": "\n",
          "36": "F",
          "37": "R",
          "38": "O",
          "39": "M",
          "4": "C",
          "40": " ",
          "41": "`",
          "42": "u",
          "43": "n",
          "44": "r",
          "45": "e",
          "46": "v",
          "47": "i",
          "48": "e",
          "49": "w",
          "5": "T",
          "50": "-",
          "51": "p",
          "52": "o",
          "53": "c",
          "54": "-",
          "55": "3",
          "56": "9",
          "57": "0",
          "58": "2",
          "59": "0",
          "6": " ",
          "60": "0",
          "61": "e",
          "62": "5",
          "63": ".",
          "64": "g",
          "65": "l",
          "66": "_",
          "67": "g",
          "68": "i",
          "69": "t",
          "7": "D",
          "70": "l",
          "71": "a",
          "72": "b",
          "73": "_",
          "74": "c",
          "75": "o",
          "76": "d",
          "77": "e",
          "78": "b",
          "79": "a",
          "8": "I",
          "80": "s",
          "81": "e",
          "82": ".",
          "83": "o",
          "84": "u",
          "85": "t",
          "86": "p",
          "87": "u",
          "88": "t",
          "89": "_",
          "9": "S",
          "90": "f",
          "91": "u",
          "92": "l",
          "93": "l",
          "94": "_",
          "95": "v",
          "96": "4",
          "97": "`",
          "editorMode": "code",
          "format": 1,
          "location": "US",
          "project": "unreview-poc-390200e5",
          "rawQuery": true,
          "rawSql": "SELECT DISTINCT post_transformation FROM `unreview-poc-390200e5.gl_gitlab_codebase.output_full_v4`\t\n\n\n\n",
          "refId": "tempvar",
          "sql": {
            "columns": [
              {
                "parameters": [

                ],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      }
    ]
  },
  "time": {
    "from": "now-6h",
    "to": "now"
  },
  "timepicker": {
  },
  "timezone": "",
  "title": "Code Completion AI Evaluations v1",
  "uid": "fecc5b69-8e38-4b4e-9fed-1c837f9c2b7m",
  "version": 38,
  "weekStart": ""
}